{% extends "layout.html"%}

{% block css%}
<script type="text/javascript" charset="UTF-8" src="{{url_for('static',filename='ue/ueditor.config.js')}}"></script>
<script type="text/javascript" charset="UTF-8" src="{{url_for('static',filename='ue/ueditor.all.min.js')}}"></script>
<script type="text/javascript" charset="UTF-8" src="{{url_for('static',filename='ue/lang/zh-cn/zh-ch.js')}}"></script>

{% endblock %}

{% block content%}
{% for msg in get_flashed_messages(category_filter=["art edit ok"])%}
            <p style="color:green">{{ msg }}</p>
{%endfor%}
<form method="post" enctype="multipart/form-data">
<div class="form-group">
    <!--<input type="hidden" value="{{art.id}}" name="文章id"> -->
    <label>标题</label>
    {{form.title(value=art.title)}}
    {% for v in form.title.errors %}
    <p style="color:red">{{ v }}</p>
    {% endfor%}
</div>
<div class="form-group">
    <label>分类</label>
    {{form.cate}}
    {% for v in form.cate.errors %}
    <p style="color:red">{{ v }}</p>
    {%endfor%}
</div>
<div class="form-group">
    <label>封面</label>
    {{form.logo}}
    {% for v in form.logo.errors %}
    <p style="color:red">{{ v }}</p>
    {% endfor%}
    <img id="imgPre" src="/static/userlogo/{{ art.logo }}" style="height:160px; weight:300px;margin-top: 6px">
    <!--<img data-src="holder.js/300x160" style="margin-top: 6px"> -->
    <br>
    <a class="btn btn-primary" style="margin-top:6px;">上传封面</a>
</div>
<div class="form-group">
    <label>内容</label>
    {{form.content(value=art.content)}}
    {% for v in form.content.errors %}
    <p style="color:red">{{ v }}</p>
    {%endfor%}
</div>
<div class="form-group">
    {{form.submit}}
    {{form.csrf_token}}
</div>
</form>

{% endblock %}
{% block js %}
<script>
    var ue = UE.getEditor("content");
    $(document).ready(function() {
        $("#m1").addClass("active");
    });
      function getFileUrl(sourceId) {
        var url;
        if (navigator.userAgent.indexOf("MSIE")>=1) { // IE
        url = document.getElementById(sourceId).value;
    }
        else if(navigator.userAgent.indexOf("Firefox")>0) { // Firefox
        url = window.URL.createObjectURL(document.getElementById(sourceId).files.item(0));
    }
        else if(navigator.userAgent.indexOf("Chrome")>0) { // Chrome
        url = window.URL.createObjectURL(document.getElementById(sourceId).files.item(0));
    }
        return url;
    }
    function preImg(sourceId, targetId) {
        var url = getFileUrl(sourceId);
        var imgPre = document.getElementById(targetId);
        imgPre.src = url;
    }

</script>
{% endblock %}